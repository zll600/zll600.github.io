import{_ as h,c as u,j as r,a,G as n,aj as o,w as i,B as l,o as m}from"./chunks/framework.grSdWIKG.js";const I=JSON.parse('{"title":"PHP Internal","description":"","frontmatter":{"tags":["programming","laravel"]},"headers":[],"relativePath":"blogs/programming/php-internal.md","filePath":"blogs/programming/php-internal.md"}'),f={name:"blogs/programming/php-internal.md"};function b(g,e,P,k,c,q){const p=l("NolebasePageProperties"),t=l("VPNolebaseInlineLinkPreview"),s=l("NolebaseGitContributors"),d=l("NolebaseGitChangelog");return m(),u("div",null,[e[15]||(e[15]=r("h1",{id:"php-internal",tabindex:"-1"},[a("PHP Internal "),r("a",{class:"header-anchor",href:"#php-internal","aria-label":'Permalink to "PHP Internal"'},"​")],-1)),n(p),e[16]||(e[16]=o('<p>尝试分析一下 PHP 内部实现。</p><h2 id="run-a-php-script" tabindex="-1">Run a PHP script <a class="header-anchor" href="#run-a-php-script" aria-label="Permalink to &quot;Run a PHP script&quot;">​</a></h2><h2 id="zend-engine" tabindex="-1">Zend Engine <a class="header-anchor" href="#zend-engine" aria-label="Permalink to &quot;Zend Engine&quot;">​</a></h2><h3 id="zend-compiler" tabindex="-1">Zend Compiler <a class="header-anchor" href="#zend-compiler" aria-label="Permalink to &quot;Zend Compiler&quot;">​</a></h3><p>Zend Compiler 是 Zend Engine 的一部分，负责将 PHP 代码编译成 Zend 中间代码(Zend Intermediate Code, ZIC)。</p>',5)),r("ul",null,[r("li",null,[n(t,{href:"https://nikic.github.io/2017/04/14/PHP-7-Virtual-machine.html",target:"_blank",rel:"noreferrer"},{default:i(()=>e[0]||(e[0]=[a("PHP-7-Virtual-machine")])),_:1})])]),e[17]||(e[17]=r("h3",{id:"rounding",tabindex:"-1"},[a("Rounding "),r("a",{class:"header-anchor",href:"#rounding","aria-label":'Permalink to "Rounding"'},"​")],-1)),r("p",null,[e[2]||(e[2]=a("参考 ")),n(t,{href:"http://wiki.php.net/rfc/rounding",target:"_blank",rel:"noreferrer"},{default:i(()=>e[1]||(e[1]=[a("floating point RFC")])),_:1})]),e[18]||(e[18]=o('<h2 id="sapi" tabindex="-1">SAPI <a class="header-anchor" href="#sapi" aria-label="Permalink to &quot;SAPI&quot;">​</a></h2><p>Server Application Programming Interface(SAPI) 是调用 Zend Engine 的入口。</p><h3 id="cli-sapi" tabindex="-1">CLI SAPI <a class="header-anchor" href="#cli-sapi" aria-label="Permalink to &quot;CLI SAPI&quot;">​</a></h3><p>PHP Cli command.</p><p>可以在 <code>/sapi/cli/php_cli.c</code> 中找到 main 函数。</p><h3 id="fpm-sapi" tabindex="-1">FPM SAPI <a class="header-anchor" href="#fpm-sapi" aria-label="Permalink to &quot;FPM SAPI&quot;">​</a></h3><p>可以在 <code>/sapi/fpm/fpm_main.c</code> 中找到 main 函数。</p><h3 id="embed-sapi" tabindex="-1">embed SAPI <a class="header-anchor" href="#embed-sapi" aria-label="Permalink to &quot;embed SAPI&quot;">​</a></h3><p>可以通过 C 语言直接调用 Zend Engine 的相关函数</p><h3 id="ggi-sapi" tabindex="-1">GGI SAPI <a class="header-anchor" href="#ggi-sapi" aria-label="Permalink to &quot;GGI SAPI&quot;">​</a></h3><h3 id="phpdbg-sapi" tabindex="-1">PHPDBG SAPI <a class="header-anchor" href="#phpdbg-sapi" aria-label="Permalink to &quot;PHPDBG SAPI&quot;">​</a></h3><h2 id="extension" tabindex="-1">Extension <a class="header-anchor" href="#extension" aria-label="Permalink to &quot;Extension&quot;">​</a></h2><h2 id="opcode-jit" tabindex="-1">Opcode JIT <a class="header-anchor" href="#opcode-jit" aria-label="Permalink to &quot;Opcode JIT&quot;">​</a></h2>',13)),r("p",null,[e[4]||(e[4]=a("参考 ")),n(t,{href:"https://wiki.php.net/rfc/jit",target:"_blank",rel:"noreferrer"},{default:i(()=>e[3]||(e[3]=[a("the JIT RFC")])),_:1})]),e[19]||(e[19]=o('<h2 id="tsrm" tabindex="-1">TSRM <a class="header-anchor" href="#tsrm" aria-label="Permalink to &quot;TSRM&quot;">​</a></h2><p>Thread Safe Resource Manager, 线程安全资源管理器。在 PHP 处理 request 的时候使用 thread 模式而不是 process 模式。</p><h2 id="zend-memory-manager" tabindex="-1">Zend Memory Manager <a class="header-anchor" href="#zend-memory-manager" aria-label="Permalink to &quot;Zend Memory Manager&quot;">​</a></h2><p>封装 C 语言的 malloc/free 等内从控制函数，并提供了 request 级别的内存管理。</p><h2 id="scripts" tabindex="-1">Scripts <a class="header-anchor" href="#scripts" aria-label="Permalink to &quot;Scripts&quot;">​</a></h2><p>一些 php 相关的可执行脚本</p><h3 id="php-config" tabindex="-1">php-config <a class="header-anchor" href="#php-config" aria-label="Permalink to &quot;php-config&quot;">​</a></h3><h3 id="phpize" tabindex="-1">phpize <a class="header-anchor" href="#phpize" aria-label="Permalink to &quot;phpize&quot;">​</a></h3><h3 id="reference" tabindex="-1">Reference <a class="header-anchor" href="#reference" aria-label="Permalink to &quot;Reference&quot;">​</a></h3>',9)),r("ul",null,[r("li",null,[n(t,{href:"https://wiki.php.net/rfc/jit",target:"_blank",rel:"noreferrer"},{default:i(()=>e[5]||(e[5]=[a("the JIT RFC")])),_:1})]),r("li",null,[n(t,{href:"https://luajit.org/dynasm.html",target:"_blank",rel:"noreferrer"},{default:i(()=>e[6]||(e[6]=[a("DynAsm")])),_:1})]),r("li",null,[n(t,{href:"https://corsix.github.io/dynasm-doc/tutorial.html",target:"_blank",rel:"noreferrer"},{default:i(()=>e[7]||(e[7]=[a("The unofficial DynASM Documentation")])),_:1})]),r("li",null,[n(t,{href:"https://github.com/google/sanitizers/wiki/AddressSanitizer",target:"_blank",rel:"noreferrer"},{default:i(()=>e[8]||(e[8]=[a("AddressSanitizer")])),_:1})]),r("li",null,[n(t,{href:"https://valgrind.org/",target:"_blank",rel:"noreferrer"},{default:i(()=>e[9]||(e[9]=[a("valgrind")])),_:1})]),r("li",null,[n(t,{href:"https://www.docker.com/blog/faster-multi-platform-builds-dockerfile-cross-compilation-guide/",target:"_blank",rel:"noreferrer"},{default:i(()=>e[10]||(e[10]=[a("test the jit with amd64 and arm64")])),_:1})])]),e[20]||(e[20]=r("h2",{id:"reference-1",tabindex:"-1"},[a("Reference "),r("a",{class:"header-anchor",href:"#reference-1","aria-label":'Permalink to "Reference"'},"​")],-1)),r("ul",null,[r("li",null,[n(t,{href:"https://php.github.io/php-src/introduction/high-level-overview.html",target:"_blank",rel:"noreferrer"},{default:i(()=>e[11]||(e[11]=[a("https://php.github.io/php-src/introduction/high-level-overview.html")])),_:1})]),r("li",null,[n(t,{href:"https://wiki.php.net/internals",target:"_blank",rel:"noreferrer"},{default:i(()=>e[12]||(e[12]=[a("https://wiki.php.net/internals")])),_:1})]),r("li",null,[n(t,{href:"https://www.phpinternalsbook.com/index.html",target:"_blank",rel:"noreferrer"},{default:i(()=>e[13]||(e[13]=[a("https://www.phpinternalsbook.com/index.html")])),_:1})]),r("li",null,[n(t,{href:"https://en.wikipedia.org/wiki/Three-address_code",target:"_blank",rel:"noreferrer"},{default:i(()=>e[14]||(e[14]=[a("https://en.wikipedia.org/wiki/Three-address_code")])),_:1})])]),n(s),n(d)])}const w=h(f,[["render",b]]);export{I as __pageData,w as default};
